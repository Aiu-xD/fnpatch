"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.encrypt = void 0;
const crypto_1 = require("crypto");
function encrypt(data, key) {
    let salt = "";
    let salted = "";
    let dx = Buffer.alloc(0);
    salt = String.fromCharCode(...Array(8)
        .fill(0)
        .map((_) => Math.floor(Math.random() * 26) + 97));
    for (let x = 0; x < 3; x++) {
        dx = (0, crypto_1.createHash)("md5")
            .update(Buffer.concat([Buffer.from(dx), Buffer.from(key), Buffer.from(salt)]))
            .digest();
        salted += dx.toString("hex");
    }
    let aes = (0, crypto_1.createCipheriv)("aes-256-cbc", Buffer.from(salted.substring(0, 64), "hex"), Buffer.from(salted.substring(64, 64 + 32), "hex"));
    return {
        ct: aes.update(data, undefined, "base64") + aes.final("base64"),
        iv: salted.substring(64, 64 + 32),
        s: Buffer.from(salt).toString("hex"),
    };
}
exports.encrypt = encrypt;
